<div class="container">


    <br><br>
    <form [formGroup]="deviceForm" *ngIf="deviceForm" class="normal-form" dir="rtl"
        (keydown.enter)="$event.preventDefault()">
        <table>
            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="onSelectcheckedCheckbox($event)"
                                formControlName="checked">بحث
                                بالقطاعات والادارات المركزية والادارات العامة</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>
            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="onSelectcheckeCustomsAreaCheckbox($event)"
                                formControlName="checkeCustomsArea">بحث
                                بالمنطقة الجمركية</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>

            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin"
                                (change)="onSelectcheckeCustomsAreaAndSectorCheckbox($event)"
                                formControlName="checkeCustomsAreaAndSector">بحث
                                بالمنطقة والقطاع</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>
        </table>
        <table>
            <tr *ngIf="checkeCustomsArea">
                <td>
                    <label style="margin: 0px 20px;"> المنطقة الجمركية</label>

                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="areasArray" formControlName="CustomsArea" bindLabel="name" bindValue="id"
                            (change)="onchangeCustomsAreas($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" CustomsAreaId != null" (click)="onSubmit(CustomsAreaId,2)">عرض
                        </button>
                    </div>
                </td>
            </tr>

            <tr *ngIf="checked">
                <td style="width: 120px;">
                    <label style="margin: 0px 20px;">القطاع</label>
                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="sections" formControlName="SectionId" bindLabel="name" bindValue="id"
                            (change)="onchangeSections($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" sectorID != null" (click)="onSubmit(sectorID,1)">عرض
                        </button>
                    </div>

                </td>
            </tr>
            <ng-container *ngIf="centersList != null">

                <tr *ngIf="checked">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة المركزية</label>
                    </td>
                    <td>
                        <div class="input-group">
                            <ng-select formControlName="Centers" bindLabel="name" bindValue="ID"
                                (change)="onchangeCenters($event)" placeholder=" اختر إدارة مركزية"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let center of centersList" [(value)]="center.ID">{{center.name}}
                                </ng-option>
                            </ng-select>
                            <button type="button" *ngIf="centerID != null" (click)="onSubmit(centerID,3)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <ng-container *ngIf="ManagmentsList != null ">

                <tr *ngIf="checked">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة العامة</label>
                    </td>
                    <td>
                        <div class="input-group">

                            <ng-select *ngIf="ManagmentsList != null" formControlName="Managment" bindLabel="name"
                                bindValue="ID" (change)="onchangeManagments($event)" placeholder=" اختر إدارة عامة"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of ManagmentsList" [(value)]="Managment.mang">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="ManagmentID != null" (click)="onSubmit(ManagmentID,4)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <!-- <ng-container *ngIf="Managments2List != null && Managments2List.length > 0">

                <tr>
                    <td>
                        <label style="margin: 0px 20px;">إدارة تحت التابعة</label>
                    </td>
                    <td>
                        <div class="input-group" [ngClass]="showSections()">

                            <ng-select *ngIf="Managments2List != null" formControlName="Managment2" bindLabel="name"
                                bindValue="ID" (change)="onchangemanagments2($event)"
                                placeholder=" اختر إدارة تحت التابعة" style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of Managments2List" [(value)]="Managment.ID">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="Managment2ID != null"
                                (click)="showManagmentDevices(Managment2ID)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container> -->
        </table>
        <table>
            <tr *ngIf="checkeCustomsAreaAndSector">
                <td>
                    <label style="margin: 0px 20px;"> المنطقة الجمركية</label>

                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="areasArray" formControlName="CustomsAreaForTwoOptions" bindLabel="name"
                            bindValue="id" (change)="onchangeCustomsAreas($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                    </div>
                </td>
            </tr>

            <tr *ngIf="checkeCustomsAreaAndSector">
                <td style="width: 120px;">
                    <label style="margin: 0px 20px;">القطاع</label>
                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="sections" formControlName="SectionIdForTwoOptions" bindLabel="name"
                            bindValue="id" (change)="onchangeSections($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" sectorID != null"
                            (click)="GetDevices3ReportByTwoOptions(sectorID,1,CustomsAreaId)">عرض
                        </button>
                    </div>

                </td>
            </tr>
            <ng-container *ngIf="centersList != null">

                <tr *ngIf="checkeCustomsAreaAndSector">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة المركزية</label>
                    </td>
                    <td>
                        <div class="input-group">
                            <ng-select formControlName="CentersForTwoOptions" bindLabel="name" bindValue="ID"
                                (change)="onchangeCenters($event)" placeholder=" اختر إدارة مركزية"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let center of centersList" [(value)]="center.ID">{{center.name}}
                                </ng-option>
                            </ng-select>
                            <button type="button" *ngIf="centerID != null"
                                (click)="GetDevices3ReportByTwoOptions(centerID,3,CustomsAreaId)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <ng-container *ngIf="ManagmentsList != null ">

                <tr *ngIf="checkeCustomsAreaAndSector">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة العامة</label>
                    </td>
                    <td>
                        <div class="input-group">

                            <ng-select *ngIf="ManagmentsList != null" formControlName="ManagmentForTwoOptions"
                                bindLabel="name" bindValue="ID" (change)="onchangeManagments($event)"
                                placeholder=" اختر إدارة عامة" style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of ManagmentsList" [(value)]="Managment.mang">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="ManagmentID != null"
                                (click)="GetDevices3ReportByTwoOptions(ManagmentID,4,CustomsAreaId)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
        </table>
        <div class="row">
            <div class="col-md-6">


                <div class="form-group">
                    <div class="input-group">

                        <label style="text-align: right;margin-left: 40px;">حالة الجهاز</label>

                        <mat-form-field>
                            <mat-select multiple formControlName="printercase" placeholder="">
                                <ng-container *ngFor="let case of printercaseArray">
                                    <mat-option (click)="onchangeCase($event)" [(value)]="case.id">{{case.name}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>

                <div class="form-group">
                    <div class="input-group">

                        <label style="text-align: right;margin-left: 40px;">نوع الجهاز</label>

                        <mat-form-field>
                            <mat-select multiple formControlName="type" placeholder="">
                                <ng-container *ngFor="let type of deviceTypeArray">
                                    <mat-option (click)="onchangeType($event)" [(value)]="  type.id">{{type.name}}
                                    </mat-option>
                                </ng-container>
                            </mat-select>
                        </mat-form-field>

                    </div>
                </div>
                <!-- <div class="button-box">
                    <div class="button-row">
                        <button id="myAnchor" mat-raised-button color="primary" type="button"
                            (click)="onSubmit()">استعلام</button>

                    </div>
                </div> -->
            </div>
        </div>

        <!--  <div class="button-box">
            <div class="button-row">
                <button id="myAnchor" mat-raised-button color="primary" type="submit">استعلام</button>

            </div>
        </div> -->
    </form>
    <br>
    <div class="button-box">
        <div class="button-row">
            <button printSectionId="print-section" mat-raised-button color="primary" type="button"
                *ngIf="listData != null && listData.length > 0" ngxPrint>طباعة</button>
        </div>
    </div>
    <div class="mat-elevation-z8" [ngClass]="{'hide':!isSearched}" id="print-section">


        <mat-toolbar style="text-align: center;">

            <ng-container  *ngIf="isSearched && listData != null && listData.length > 0 ">
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
                تقرير بأجهزة {{modeltype}} التي
                {{printercasetype}}
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
            </ng-container>
            <!-- <ng-container [ngSwitch]="type" *ngIf="isSearched && listData != null && listData.length > 0 ">
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
                <span *ngSwitchCase="1" style="direction: ltr;"> تقرير بأجهزة كمبيوتر التي
                    {{printercasetype}}</span>
                <span *ngSwitchCase="2"> تقرير بالطابعات التي {{printercasetype}}</span>
                <span *ngSwitchCase="3"> تقرير بماكينات التصوير التي {{printercasetype}}</span>
                <span *ngSwitchCase="4"> تقرير بأجهزة الماسح الضوئي التي {{printercasetype}}</span>
                <span *ngSwitchCase="5"> تقرير بأجهزة الفاكس التي {{printercasetype}}</span>
                <span *ngSwitchCase="6"> تقرير بالشاشات التي {{printercasetype}}</span>
                <span *ngSwitchCase="7"> تقرير بأجهزة أخرى التي {{printercasetype}}</span>
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
            </ng-container> -->

            <ng-container *ngIf="isSearched && listData!= null && listData.length == 0 ">
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>

                <span> لا يوجد نتائج للبحث </span>

                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
            </ng-container>

        </mat-toolbar>

        <table class="table table-striped  table-hover table-border" cellspacing="0"
            *ngIf="listData != null && listData.length > 0" dir="rtl">
            <thead class="thead-dark">
                <th style="text-align: center;border: 1px solid black">م</th>
                <th style="text-align: center;border: 1px solid black">الادارة</th>
                <th style="text-align: center;border: 1px solid black">عدد الاجهزة</th>
                <th style="text-align: center;border: 1px solid black">المنطقة الجمركية</th>

                <!--                 <th style="text-align: center;border: 1px solid black">code</th>
 -->

            </thead>
            <tbody>
                <!-- <tr *ngIf="this.listData.data.length==0" [class.text-danger]="!isValid && this.listData.data.length==0">
        <td class="font-italic text-center" colspan="8">
          لا يوجد نتائج عن الاستعلام
        </td>
      </tr> -->

                <tr *ngFor="let item of listData;let i=index;" style="text-align: center;">
                    <td style="border: 1px solid black;width: 50px;">{{i+1}}</td>
                    <td style="border: 1px solid black;width: 350px;"><a style="text-decoration: none;color: black">
                            {{item.Structure}} </a>

                    </td>
                    <td style="text-align: right;border: 1px solid black;margin: 0px;width:min-content;">

                        <ul style="padding-right: 30px;" *ngIf="listData[i].Devices3s != null">
                            <li *ngFor="let item1 of listData[i].Devices3s ; let j=index">
                                <ng-container style="margin-right: 30px;"> <span> {{item1.numberofprinter}}</span> <span
                                        [ngSwitch]="item1.model">
                                        <span *ngSwitchCase="1"> كمبيوتر |</span>
                                        <span *ngSwitchCase="2"> طابعة |</span>
                                        <span *ngSwitchCase="3">ماكينة تصوير |</span>
                                        <span *ngSwitchCase="4">ماسح ضوئي |</span>
                                        <span *ngSwitchCase="5"> فاكس |</span>
                                        <span *ngSwitchCase="6">شاشة |</span>
                                        <span *ngSwitchCase="7"> أخرى |</span>
                                    </span><span [ngSwitch]="item1.printercase">
                                        <span *ngSwitchCase="1"> يعمل جديد |</span>
                                        <span *ngSwitchCase="2">لا يعمل جديد |</span>
                                        <span *ngSwitchCase="3">يعمل قديم |</span>
                                        <span *ngSwitchCase="4">لا يعمل قديم |</span>
                                    </span><span *ngIf="item1.devicemodel != null">
                                        {{item1.devicemodel}}|
                                    </span>
                                    <span>
                                        {{item1.devicemark}}
                                    </span>
                                </ng-container>
                            </li>
                        </ul>

                    </td>
                    <td style="border: 1px solid black">
                        <ng-container *ngIf="item.CustomsArea == 1"> شمالية و غربية</ng-container>
                        <ng-container *ngIf="item.CustomsArea == 2 "> وسطى و جنوبية</ng-container>
                        <ng-container *ngIf="item.CustomsArea == 3 "> شرقية</ng-container>
                    </td>
                </tr>
            </tbody>
        </table>
        <br><br>
    </div>
</div>