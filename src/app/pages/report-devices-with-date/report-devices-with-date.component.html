<div class="container">
    <br><br>

    <form [formGroup]="reportByYearForm" *ngIf="reportByYearForm" class="normal-form" dir="rtl"
        (keydown.enter)="$event.preventDefault()">
        <table>
            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="onSelectcheckedCheckbox($event)"
                                formControlName="checked">بحث
                                بالقطاعات والادارات المركزية والادارات العامة</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>
            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin" (change)="onSelectcheckeCustomsAreaCheckbox($event)"
                                formControlName="checkeCustomsArea">بحث
                                بالمنطقة الجمركية</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>

            <tr>

                <td>
                    <div class="input-group">
                        <section class="example-section">
                            <mat-checkbox class="example-margin"
                                (change)="onSelectcheckeCustomsAreaAndSectorCheckbox($event)"
                                formControlName="checkeCustomsAreaAndSector">بحث
                                بالمنطقة والقطاع</mat-checkbox>
                        </section>
                    </div>

                </td>
            </tr>
        </table>
        <table>
            <tr *ngIf="checkeCustomsArea">
                <td>
                    <label style="margin: 0px 20px;"> المنطقة الجمركية</label>

                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="areasArray" formControlName="CustomsArea" bindLabel="name" bindValue="id"
                            (change)="onchangeCustomsAreas($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" CustomsAreaId != null"
                            (click)="GetDevices3ReportByYear(CustomsAreaId,2)">عرض
                        </button>
                    </div>
                </td>
            </tr>

            <tr *ngIf="checked">
                <td style="width: 120px;">
                    <label style="margin: 0px 20px;">القطاع</label>
                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="sections" formControlName="SectionId" bindLabel="name" bindValue="id"
                            (change)="onchangeSections($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" sectorID != null"
                            (click)="GetDevices3ReportByYear(sectorID,1)">عرض
                        </button>
                    </div>

                </td>
            </tr>
            <ng-container *ngIf="centersList != null">

                <tr *ngIf="checked">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة المركزية</label>
                    </td>
                    <td>
                        <div class="input-group">
                            <ng-select formControlName="Centers" bindLabel="name" bindValue="ID"
                                (change)="onchangeCenters($event)" placeholder=" اختر إدارة مركزية"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let center of centersList" [(value)]="center.ID">{{center.name}}
                                </ng-option>
                            </ng-select>
                            <button type="button" *ngIf="centerID != null"
                                (click)="GetDevices3ReportByYear(centerID,3)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <ng-container *ngIf="ManagmentsList != null ">

                <tr *ngIf="checked">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة العامة</label>
                    </td>
                    <td>
                        <div class="input-group">

                            <ng-select *ngIf="ManagmentsList != null" formControlName="Managment" bindLabel="name"
                                bindValue="ID" (change)="onchangeManagments($event)" placeholder=" اختر إدارة عامة"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of ManagmentsList" [(value)]="Managment.mang">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="ManagmentID != null"
                                (click)="GetDevices3ReportByYear(ManagmentID,4)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <ng-container *ngIf="Managments2List != null && Managments2List.length > 0">

                <tr>
                    <td>
                        <label style="margin: 0px 20px;">إدارة تحت التابعة</label>
                    </td>
                    <td>
                        <div class="input-group" [ngClass]="showSections()">

                            <ng-select *ngIf="Managments2List != null" formControlName="Managment2" bindLabel="name"
                                bindValue="ID" (change)="onchangemanagments2($event)"
                                placeholder=" اختر إدارة تحت التابعة" style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of Managments2List" [(value)]="Managment.ID">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="Managment2ID != null"
                                (click)="showManagmentDevices(Managment2ID)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
        </table>
        <table>
            <tr *ngIf="checkeCustomsAreaAndSector">
                <td>
                    <label style="margin: 0px 20px;"> المنطقة الجمركية</label>

                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="areasArray" formControlName="CustomsAreaForTwoOptions" bindLabel="name"
                            bindValue="id" (change)="onchangeCustomsAreas($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <!-- <button type="button" *ngIf=" !checkeCustomsAreaAndSector"
                            (click)="GetdevicesNeedsForSectorCenters(CustomsAreaId,2)">عرض
                        </button> -->
                    </div>
                </td>
            </tr>

            <tr *ngIf="checkeCustomsAreaAndSector">
                <td style="width: 120px;">
                    <label style="margin: 0px 20px;">القطاع</label>
                </td>
                <td>
                    <div class="input-group">
                        <ng-select [items]="sections" formControlName="SectionIdForTwoOptions" bindLabel="name"
                            bindValue="id" (change)="onchangeSections($event)" placeholder="Select Section"
                            style="width: 300px; margin: 0px 20px;">
                        </ng-select>
                        <button type="button" *ngIf=" sectorID != null"
                            (click)="GetDevices3ReportByTwoOptions(sectorID,1,CustomsAreaId)">عرض
                        </button>
                    </div>

                </td>
            </tr>
            <ng-container *ngIf="centersList != null">

                <tr *ngIf="checkeCustomsAreaAndSector">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة المركزية</label>
                    </td>
                    <td>
                        <div class="input-group">
                            <ng-select formControlName="CentersForTwoOptions" bindLabel="name" bindValue="ID"
                                (change)="onchangeCenters($event)" placeholder=" اختر إدارة مركزية"
                                style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let center of centersList" [(value)]="center.ID">{{center.name}}
                                </ng-option>
                            </ng-select>
                            <button type="button" *ngIf="centerID != null"
                                (click)="GetDevices3ReportByTwoOptions(centerID,3,CustomsAreaId)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
            <ng-container *ngIf="ManagmentsList != null ">

                <tr *ngIf="checkeCustomsAreaAndSector">
                    <td>
                        <label style="margin: 0px 20px;">الإدارة العامة</label>
                    </td>
                    <td>
                        <div class="input-group">

                            <ng-select *ngIf="ManagmentsList != null" formControlName="ManagmentForTwoOptions"
                                bindLabel="name" bindValue="ID" (change)="onchangeManagments($event)"
                                placeholder=" اختر إدارة عامة" style="width: 300px; margin: 0px 20px;">
                                <ng-option *ngFor="let Managment of ManagmentsList" [(value)]="Managment.mang">
                                    {{Managment.name}}</ng-option>
                            </ng-select>
                            <button type="button" *ngIf="ManagmentID != null"
                                (click)="GetDevices3ReportByTwoOptions(ManagmentID,4,CustomsAreaId)">عرض
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-container>
        </table>
        <div class="row">

            <div class="form-group">

                <mat-radio-group style="color: azure; align-items: initial;margin: 10px;" aria-label="Select an option"
                    formControlName="flag" [class.is-invalid]="(submitted || f.flag.touched) && f.flag.errors">
                    <mat-radio-button style="color: black;" value="2">&nbsp;&nbsp; <div class="input-group">
                            <label style="text-align: right;margin-left: 20px;"> سنة التوريد : </label>

                            <div>
                                <mat-form-field appearance="fill">
                                    <mat-label> اختر سنة (مطلوب)</mat-label>
                                    <select matNativeControl required formControlName="year">
                                        <option *ngFor="let year of years" [value]="year">{{year}}</option>
                                    </select>
                                </mat-form-field>
                                <!-- &nbsp;&nbsp;&nbsp;&nbsp;
                                <button id="myAnchor" mat-raised-button color="primary" type="button">استعلام</button> -->

                            </div>

                        </div>
                    </mat-radio-button>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <mat-radio-button style="color: black;" value="1">&nbsp;&nbsp;<ng-container>
                            <div class="row">
                                <div class="form-group">
                                    <div class="input-group">
                                        <label style="text-align: right;margin-left: 40px;">من : </label>

                                        <mat-form-field>
                                            <input formControlName="fromDate" [(value)]='fromDate' matInput
                                                [matDatepicker]="pickerfromDate" placeholder="">
                                            <mat-datepicker-toggle matSuffix [for]="pickerfromDate">
                                            </mat-datepicker-toggle>
                                            <mat-datepicker #pickerfromDate></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="input-group">
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        <label style="text-align: right;margin-left: 40px;">إلى : </label>

                                        <mat-form-field>
                                            <input formControlName="toDate" [(value)]='toDate' matInput
                                                [matDatepicker]="pickertoDate" placeholder="">
                                            <mat-datepicker-toggle matSuffix [for]="pickertoDate">
                                            </mat-datepicker-toggle>
                                            <mat-datepicker #pickertoDate></mat-datepicker>
                                        </mat-form-field>
                                        <!-- &nbsp;&nbsp;&nbsp;&nbsp;
                                        <button id="myAnchor" style="height:35px;margin-top: 20px;" mat-raised-button
                                            color="primary" type="button"
                                            >استعلام</button> -->
                                    </div>

                                </div>
                            </div>


                        </ng-container>
                    </mat-radio-button>
                </mat-radio-group>

            </div>
        </div>

    </form>

    <div class="button-box">
        <div class="button-row">
            <button printSectionId="print-section" mat-raised-button color="primary" type="button"
                *ngIf="listData != null && listData.length > 0" ngxPrint>طباعة</button>
        </div>
    </div>
    <div class="mat-elevation-z8" [ngClass]="{'hide':!isSearched}" id="print-section">


        <mat-toolbar style="text-align: center;">
            <span class="example-fill-remaining-space"></span>

            <ng-container *ngIf="isSearched && listData.length > 0 && flag==1">


                <span class="example-fill-remaining-space"> تقرير بالأجهزة التي تم توريدها عام {{printyear}}</span>
                <span class="example-fill-remaining-space"></span>

            </ng-container>
            <ng-container *ngIf="isSearched && listData.length > 0 && flag==0" style="text-align: center;">
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>

                <span dir="ltr"> {{from}} تقرير بالأجهزة التي تم توريدها في الفترة من {{to}} إلى</span>
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>

            </ng-container>
            <ng-container *ngIf="isSearched && listData.length == 0" style="text-align: center;">

                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
                <span> لا يوجد نتائج للبحث </span>

                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>
                <span class="example-fill-remaining-space"></span>

            </ng-container>

        </mat-toolbar>

        <table class="table table-striped  table-hover table-border" cellspacing="0"
            *ngIf="listData != null && listData.length > 0" dir="rtl">
            <thead class="thead-dark">
                <th style="text-align: center;border: 1px solid black">م</th>
                <th style="text-align: center;border: 1px solid black;width: 300px;">الإدارة</th>
                <th style="text-align: center;border: 1px solid black">حالة الجهاز</th>
                <th style="text-align: center;border: 1px solid black">نوع الجهاز</th>
                <th style="text-align: center;border: 1px solid black">الماركة</th>
                <th style="text-align: center;border: 1px solid black">عدد الأجهزة</th>
                <th style="text-align: center;border: 1px solid black">الموديل</th>
                <th style="text-align: center;border: 1px solid black">المنطقة الجمركية</th>
                <th style="text-align: center;border: 1px solid black">تاريخ التوريد</th>
                <!--                 <th style="text-align: center;border: 1px solid black">code</th>
 -->
            </thead>
            <tbody>

                <tr *ngFor="let item of listData;let i=index;" style="text-align: center;">
                    <td style="border: 1px solid black">{{i+1}}</td>
                    <td style="border: 1px solid black"><a style="text-decoration: none;color: black;">
                            {{item.Structure}} </a> </td>


                    <td style="border: 1px solid black">

                        <ng-container *ngIf="item.printercase == 1"> يعمل جديد</ng-container>
                        <ng-container *ngIf="item.printercase == 2 "> لا يعمل جديد</ng-container>
                        <ng-container *ngIf="item.printercase == 3 "> يعمل قديم</ng-container>
                        <ng-container *ngIf="item.printercase == 4 "> لا يعمل قديم</ng-container>
                    </td>
                    <td style="border: 1px solid black">
                        <ng-container *ngIf="item.model == 1"> كمبيوتر</ng-container>
                        <ng-container *ngIf="item.model == 2 "> طابعة</ng-container>
                        <ng-container *ngIf="item.model == 3 "> ماكينة تصوير</ng-container>
                        <ng-container *ngIf="item.model == 4 "> ماسح ضوئي</ng-container>
                        <ng-container *ngIf="item.model == 5 ">فاكس </ng-container>
                        <ng-container *ngIf="item.model == 6 "> شاشة</ng-container>
                        <ng-container *ngIf="item.model == 7 "> أخرى</ng-container>
                    </td>
                    <td style="border: 1px solid black">{{item.markName}}</td>
                    <td style="border: 1px solid black">{{item.numberofprinter}}</td>
                    <td style="border: 1px solid black">{{item.devicemodel}}</td>
                    <td style="border: 1px solid black">
                        <ng-container *ngIf="item.CustomsArea == 1"> شمالية و غربية</ng-container>
                        <ng-container *ngIf="item.CustomsArea == 2 "> وسطى و جنوبية</ng-container>
                        <ng-container *ngIf="item.CustomsArea == 3 "> شرقية</ng-container>
                    </td>
                    <td style="border: 1px solid black">{{this.datepipe.transform(item.devicedate|date , 'yyyy-MM-dd')}}
                    </td>
                    <!--                     <td style="border: 1px solid black">{{item.cod}}</td>
 -->

                </tr>

            </tbody>
        </table>
        <br><br>
    </div>
</div>